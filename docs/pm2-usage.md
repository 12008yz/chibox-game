# PM2 Management - ChiBox Game

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã PM2

### üîç –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

```bash
pm2 status
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å –∏—Ö ID, –∏–º–µ–Ω–∞–º–∏, —Å—Ç–∞—Ç—É—Å–æ–º, CPU –∏ –ø–∞–º—è—Ç—å—é.

### üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã

```bash
pm2 start ecosystem.config.js --env production
pm2 save
```

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ ID

```bash
pm2 start 0    # –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å ID 0
pm2 start 1    # –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å ID 1
```

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ –∏–º–µ–Ω–∏

```bash
pm2 start chibox-cron
```

### üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

#### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

```bash
pm2 stop all
```

#### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

```bash
pm2 stop 0              # –ü–æ ID
pm2 stop chibox-cron    # –ü–æ –∏–º–µ–Ω–∏
```

#### –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

```bash
pm2 delete 0            # –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å ID 0
pm2 delete all          # –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
```

### üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

#### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

```bash
pm2 restart all
```

#### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

```bash
pm2 restart 0           # –ü–æ ID
pm2 restart chibox-cron # –ü–æ –∏–º–µ–Ω–∏
```

#### Graceful reload (–±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞)

```bash
pm2 reload all
pm2 reload 0
```

### üìã –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
pm2 logs              # –õ–æ–≥–∏ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 logs 0            # –õ–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å ID 0
pm2 logs chibox-cron  # –õ–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ –∏–º–µ–Ω–∏
pm2 logs --lines 100  # –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
pm2 monit             # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

#### –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤

```bash
pm2 flush             # –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏
pm2 flush 0           # –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å ID 0
```

### üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

#### –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ü–µ—Å—Å–µ

```bash
pm2 describe 0        # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ
pm2 show chibox-cron  # –¢–æ –∂–µ —Å–∞–º–æ–µ –ø–æ –∏–º–µ–Ω–∏
```

#### –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
pm2 save              # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
```

#### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

```bash
pm2 resurrect         # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

```bash
pm2 startup           # –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ PM2
pm2 save              # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pm2 unstartup         # –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è ChiBox

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫ (–ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ
pm2 restart all

# –ò–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤–æ—Ä–∫–µ—Ä—ã (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ achievementService)
pm2 restart 0 1 2 3
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫

```bash
# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs --lines 50

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫
pm2 logs | grep -i error
```

### –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏

```bash
# –ë—ã—Å—Ç—Ä–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
pm2 stop all

# –£–±–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (–µ—Å–ª–∏ stop –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç)
pm2 kill

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
pm2 start ecosystem.config.js --env production
pm2 save
```

## üìä –ü–æ–ª–µ–∑–Ω—ã–µ –∞–ª–∏–∞—Å—ã

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `.bashrc` –∏–ª–∏ `.profile`:

```bash
alias pm2s="pm2 status"
alias pm2l="pm2 logs"
alias pm2r="pm2 restart all"
alias pm2st="pm2 stop all"
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

1. **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ** –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ `pm2 restart` –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞: `pm2 save`
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã** - –µ—Å–ª–∏ –ø–∞–º—è—Ç—å —Ä–∞—Å—Ç–µ—Ç, –≤–æ–∑–º–æ–∂–Ω–∞ —É—Ç–µ—á–∫–∞
4. **–õ–æ–≥–∏ –∑–∞–Ω–∏–º–∞—é—Ç –º–µ—Å—Ç–æ** - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–π—Ç–µ `pm2 flush`
